<!DOCTYPE HTML>
<html>

<head>
	<link rel="bookmark"  type="image/x-icon"  href="/img/logo_miccall.png"/>
	 <link rel="shortcut icon" href="/img/logo_miccall.png">
	
			
    <title>
    B-Tree
    </title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="/css/mic_main.css" />
    <link rel="stylesheet" href="/css/dropdownMenu.css" />
    
    	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	
    <noscript>
        <link rel="stylesheet" href="/css/noscript.css" />
    </noscript>

			    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>
    <script src="/js/main.js"></script>
	
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>
    
		
<!-- Layouts -->



<!--  代码渲染  -->
<link rel="stylesheet" href="/css/prism_default.css" />
<link rel="stylesheet" href="/css/typo.css" />
<!-- 文章页 -->
<body class="is-loading">
   <script type="text/javascript" color="0,0,255" opacity='0.7' zIndex="-2" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script>
    <!-- Wrapper 外包 s-->
    <div id="wrapper" class="fade-in">
        <!-- Intro 头部显示 s -->
        <!-- Intro 头部显示 e -->
        <!-- Header 头部logo start -->
        <header id="header">
    <a href="/" class="logo">罪歌moecopilot</a>
</header>
        <!-- Nav 导航条 start -->
        <nav id="nav" class="special" >
			<ul class="menu links" >
			<!-- Homepage  主页  -->
			<li >
				<a href="/" rel="nofollow">主页</a>
			</li>
			<!-- categories_name  分类   -->
			
			<li class="active">
				<a href="#s1">分类</a>
						<ul class="submenu">
							<li>
							<a class="category-link" href="/categories/code/">code</a>
						</ul>
			</li>
			
			<!-- archives  归档   -->
			
			<li class="active">
				<a href="#s1">归档</a>
						<ul class="submenu">
							<li>
							<a class="archive-link" href="/archives/2018/01/">January 2018</a>
						</ul>
			</li>
			

				<!-- Pages 自定义   -->
				
				<li>
					<a href="/tag/" title="标签">
						标签
					</a>
				</li>
				
				<li>
					<a href="/gallery/" title="图库">
						图库
					</a>
				</li>
				


			</ul>
			<!-- icons 图标   -->
			<ul class="icons">
					
						<li><a href="https://github.com/moecopilot" class="icon fa-github"><span class="label">GitHub</span></a></li>
					
					
					
					
			</ul>
</nav>


        <div id="main" >
            <div class ="post_page_title_img" style="height: 25rem;background-image: url(/gallery/copy.png);background-position: center; background-repeat:no-repeat; background-size:cover;-moz-background-size:cover;overflow:hidden;" >
                <a href="#" style="padding: 4rem 4rem 2rem 4rem ;"><h2 >复制插入版权信息功能的实现</h2></a>
            </div>
            <!-- Post -->
            <div class="typo" style="padding: 3rem;">
                <blockquote>
<p>著作权归罪歌moecopilot本人所有。商业转载请联系作者 QQ 1993713026 获得授权，非商业转载请注明出处。<br>Moecopilot is the original author. Please give credit to the original author when you use it elsewhere.  </p>
</blockquote>
<h1 id="在知乎或者简书复制的文本为什么会自带一些版权声明，这个功能是如何实现的"><a href="#在知乎或者简书复制的文本为什么会自带一些版权声明，这个功能是如何实现的" class="headerlink" title="在知乎或者简书复制的文本为什么会自带一些版权声明，这个功能是如何实现的?"></a>在知乎或者简书复制的文本为什么会自带一些版权声明，这个功能是如何实现的?</h1><h1 id="我很好奇"><a href="#我很好奇" class="headerlink" title="我很好奇"></a>我很好奇</h1><pre><code>著作权归作者所有。
商业转载请联系作者获得授权，非商业转载请注明出处。
作者：
链接：
来源：知乎
</code></pre><p>和  </p>
<pre><code>作者：
链接：
來源：简书
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。
</code></pre><p>说实话我觉得知乎和简书他俩的名字还挺押韵……<br>查了查，大致明白了这个玩意的原理<br>原文这里<a href="https://segmentfault.com/q/1010000003986612" target="_blank" rel="noopener">https://segmentfault.com/q/1010000003986612</a>  </p>
<pre><code>大体思路：
答案区域监听copy事件，并阻止这个事件的默认行为。
获取选中的内容（&lt;font color = red &gt;window.getSelection()&lt;/font&gt;）加上版权信息，
然后设置到剪切板（&lt;font color = red &gt;clipboardData.setData()&lt;/font&gt;）。
</code></pre><p>下面的代码实现了一个简单的DEMO  </p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">></span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span>
<span class="token operator">&lt;</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>title<span class="token operator">></span>test<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span>
<span class="token operator">&lt;</span>body<span class="token operator">></span>
    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"answer"</span><span class="token operator">></span>测试数据<span class="token operator">&lt;</span>b<span class="token operator">></span>test<span class="token operator">&lt;</span><span class="token operator">/</span>b<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token operator">&lt;</span>script<span class="token operator">></span>
        <span class="token keyword">function</span> <span class="token function">setClipboardText</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{</span> 
            event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> node <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//对documentfragment不熟，不知道怎么获取里面的内容，用了一个比较笨的方式</span>
            node<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRangeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cloneContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> htmlData <span class="token operator">=</span> <span class="token string">'&lt;div>著作权归作者所有。&lt;br />'</span> 
                            <span class="token operator">+</span> <span class="token string">'商业转载请联系作者获得授权，非商业转载请注明出处。&lt;br />'</span>
                            <span class="token operator">+</span> <span class="token string">'作者：tiantian&lt;br />链接：http://segmentfault.com/u/tiantian_&lt;br />'</span>
                            <span class="token operator">+</span> <span class="token string">'来源：segmentfault&lt;br />&lt;br />'</span> 
                            <span class="token operator">+</span> node<span class="token punctuation">.</span>innerHTML 
                            <span class="token operator">+</span> <span class="token string">'&lt;/div>'</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> textData <span class="token operator">=</span> <span class="token string">'著作权归作者所有。\n'</span> 
                            <span class="token operator">+</span> <span class="token string">'商业转载请联系作者获得授权，非商业转载请注明出处。\n'</span>
                            <span class="token operator">+</span> <span class="token string">'作者：tiantian\n链接：http://segmentfault.com/u/tiantian_\n'</span>
                            <span class="token operator">+</span> <span class="token string">'来源：segmentfault\n\n'</span> 
                            <span class="token operator">+</span> window<span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRangeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>clipboardData<span class="token punctuation">)</span><span class="token punctuation">{</span>  
                event<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token string">"text/html"</span><span class="token punctuation">,</span> htmlData<span class="token punctuation">)</span><span class="token punctuation">;</span> 
                event<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token string">"text/plain"</span><span class="token punctuation">,</span>textData<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>clipboardData<span class="token punctuation">)</span><span class="token punctuation">{</span>  
                <span class="token keyword">return</span> window<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token string">"text"</span><span class="token punctuation">,</span> textData<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span><span class="token punctuation">;</span>  
        <span class="token keyword">var</span> answer <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"answer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        answer<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'copy'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">setClipboardText</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span>
</code></pre>
<p>转自<a href="https://segmentfault.com/u/tiantian_" target="_blank" rel="noopener">tiantian</a>  </p>
<p>我设了一个测试网站，嵌入（iframe）在这里了qwq  </p>
<p><iframe src="http://b-tree.top/testCopy" style="width:100%;height:100px;"></iframe>  </p>
<textarea style="width:100%;height:200px;" placeholder="粘贴在这里试一试喵叽"></textarea>

<p>超好玩哈哈哈哈或或或或  </p>
<p>而在这里<a href="https://www.zhihu.com/question/38140568" target="_blank" rel="noopener">https://www.zhihu.com/question/38140568</a>  </p>
<p><a href="http://static.zhihu.com/static/revved/-/js/closure/common.d3bfcd50.js" target="_blank" rel="noopener">http://static.zhihu.com/static/revved/-/js/closure/common.d3bfcd50.js</a>  </p>
<pre>

 var Qy = function(a, b, c) {
  function d(a, b) {
     return ["著作权归作者所有。",
       "商业转载请联系作者获得授权，非商业转载请注明出处。",
       "作者：" + b, "链接：" + a, "来源：知乎",
       "", ""
     ]
   }

   function f(a, b, c) {
     return " div\x3e" + d(b, c).join(
         " br /\x3e") + a +
       " /div\x3e"
   }

   function g(a) {
     var g = z.Kq(),
       m = g && (0,
         z.x)(g.Fd());
     if (m && !(42 > m.length)) {
       if ("object" === typeof a.originalEvent
         .clipboardData && (a.originalEvent
           .clipboardData.setData(
             "text/html", f(g.Mf(), b,
               c)),
           a.originalEvent.clipboardData
           .setData("text/plain", d(b,
             c).join("\n") + m),
           0 < a.originalEvent.clipboardData
           .getData("text/plain").length
         )) {
         a.preventDefault();
         return
       }
       if (window.getSelection) {
         a = g.Mf();
         var n = (0,
           window.$)(f(a, b, c)).css({
           position: "fixed",
           left: "-9999px"
         }).appendTo("body");
         window.getSelection().selectAllChildren(
           n.get(0));
         (0,
           window.setTimeout)(function() {
           g.select();
           n.remove()
         }, 200)
       }
     }
   }
   a && b && c && (z.Da(b, "http") ||
     (b = window.location.protocol +
       "//" + window.location.host +
      b),
    a.on("copy", g))
};

</pre>

<p>转自<a href="https://www.zhihu.com/people/Rufus/activities" target="_blank" rel="noopener">鲁小夫</a></p>
<p>如果答案设置了不能复制，则阻止copy事件，并显示提示信息，如果复制的文本长度小于42的话，不会加上版权信息。  </p>
<blockquote>
<p>关于copy事件:<br><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLElement/oncopy" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLElement/oncopy</a><br><a href="http://codebits.glennjones.net/editing/setclipboarddata.htm" target="_blank" rel="noopener">http://codebits.glennjones.net/editing/setclipboarddata.htm</a>  </p>
<blockquote>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>oncopy属性用来获取或设置当前元素的copy事件的事件处理函数.  </p>
<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><pre><code>element.oncopy = functionRef;
</code></pre><p>functionRef 是一个函数名或者函数表达式.  </p>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><pre><code>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;oncopy示例演示&lt;/title&gt;

&lt;script&gt;
  function log(txt)
  {
    document.getElementById(&quot;log&quot;).appendChild(document.createTextNode(txt + &quot;\n&quot;));
  }
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;div oncopy=&quot;log(&#39;复制被阻止!&#39;); return false;&quot;&gt;试着复制这句话!&lt;/div&gt;

&lt;h3&gt;Log&lt;/h3&gt;
&lt;textarea rows=&quot;15&quot; cols=&quot;80&quot; id=&quot;log&quot; readonly=&quot;true&quot;&gt;&lt;/textarea&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><h2 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h2><p>上例演示了如何禁止复制浏览器中的一段话.  </p>
<h2 id="规范"><a href="#规范" class="headerlink" title="规范"></a>规范</h2><p>当用户尝试复制选中元素或文本时会触发copy事件.  </p>
</blockquote>
<p>glennjones给出了更加复杂的js，包括OnCopy日志的提取</p>
<blockquote>
<ul>
<li><p>Some of the current browsers support a clipboardData property as part of a copy event. This should allow you to set the clipboard data or append custom data as a user copies an object. The support is patchy and mostly incomplete. The IE interface is older than the rest, but has had support for a while where as Chrome and Safari support has only recently been added. With IE you can only set two fixed data types Text or URL.</p>
</li>
<li><p>When parts of this paragraph of text are copied an event should fire that alters the copied test. When pasted into the box below you should see a custom message. It will currently only work with IE Chrome and Safari. Try it out by copying and pasting this paragraph into the input box below.</p>
<h2 id="The-code"><a href="#The-code" class="headerlink" title="The code"></a>The code</h2></li>
</ul>
<pre class=" language-js"><code class="language-js">window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">var</span> node <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'edit-box'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> copyNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'custom-copy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    copyNode<span class="token punctuation">.</span>oncopy <span class="token operator">=</span><span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'copy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>clipboardData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>
                <span class="token string">'text/xcustom'</span><span class="token punctuation">,</span> <span class="token string">'Added this custom data at copy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">var</span> setStatus <span class="token operator">=</span> e<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>
                <span class="token string">'text/plain'</span><span class="token punctuation">,</span> <span class="token string">'This is not the text you copied, it '</span> <span class="token operator">+</span>
                <span class="token string">'was changed by the copy event handler'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setData: '</span> <span class="token operator">+</span> setStatus<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>clipboardData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span>returnValue <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> setStatus <span class="token operator">=</span> window<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>
                <span class="token string">'Text'</span><span class="token punctuation">,</span> <span class="token string">'This is not the text you copied, it '</span> <span class="token operator">+</span>
                <span class="token string">'was changed by the copy event handler'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setData: '</span> <span class="token operator">+</span> setStatus<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    node<span class="token punctuation">.</span>onpaste <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'paste'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>clipboardData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'event.clipboardData'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span>types<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'event.clipboardData.types'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment" spellcheck="true">// Look for a types property that is undefined</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isArray</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span>types<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'event.clipboardData.types is undefined'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment" spellcheck="true">// Loop the data store by type and display it</span>
                <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> e<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span>types<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">var</span> key <span class="token operator">=</span> e<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span>types<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> val <span class="token operator">=</span> e<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">': '</span> <span class="token operator">+</span> key <span class="token operator">+</span> <span class="token string">' - '</span> <span class="token operator">+</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    i<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// Look for access to data if types array is missing</span>
                <span class="token keyword">var</span> text <span class="token operator">=</span> e<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token string">'text/plain'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> url <span class="token operator">=</span> e<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token string">'text/uri-list'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> html <span class="token operator">=</span> e<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token string">'text/html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> custom <span class="token operator">=</span> e<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token string">'text/xcustom'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'text/plain - '</span> <span class="token operator">+</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">!==</span> undefined<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'text/uri-list - '</span> <span class="token operator">+</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>html <span class="token operator">!==</span> undefined<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'text/html - '</span> <span class="token operator">+</span> html<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>custom <span class="token operator">!==</span> undefined<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'text/xcustom - '</span> <span class="token operator">+</span> custom<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment" spellcheck="true">// IE event is attached to the window object</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>clipboardData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'window.clipboardData'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// The schema is fixed</span>
            <span class="token keyword">var</span> text <span class="token operator">=</span> window<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token string">'Text'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> url <span class="token operator">=</span> window<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token string">'URL'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Text - '</span> <span class="token operator">+</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'URL - '</span> <span class="token operator">+</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">// Needs a few msec to excute paste</span>
        window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>logContents<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// Button events</span>
    <span class="token keyword">var</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'clear-logs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    btn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">clearLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">logContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> node <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'edit-box'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Current contents - '</span> <span class="token operator">+</span> node<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> node <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'log-box'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> li <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span>
    li<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    node<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>li<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">clearLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> node <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'log-box'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>firstChild<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        node<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>firstChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">isArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> obj <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">propertyIsEnumerable</span><span class="token punctuation">(</span><span class="token string">'length'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> 
        <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
</blockquote>
</blockquote>
<p>我写了一个这样的页面(有些浏览器不管用QAQ)：  </p>
<hr>
<p><iframe src="http://b-tree.top/copylog" style="width:100%;height:300px;"></iframe>  </p>
<hr>
<p>那下一步就是要在整个博客中应用版权代码了。。  </p>
<p>由于我是用hexo搭建的这个blog，理论上来说需要在主题中更改模板。</p>
<p>于是这篇就先到这里，下一篇我们来研究如何更改hexo的主题文件~</p>

            </div>

            <!-- Post Comments -->
            
    <!-- 使用 changyan -->
<div id="changyan-comment">
    <!--PC和WAP自适应版-->
<div id="SOHUCS" sid="2018/01/12/copyevent/"  ></div>
<script type="text/javascript">
(function(){
var appid = 'cytpK5wmO';
var conf = '0a769799987dc5bb3ba10140a583aca9';
var width = window.innerWidth || document.documentElement.clientWidth;
if (width < 960) {
window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>

</div>
<style>
    #changyan-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>


        </div>
        <!-- Copyright 版权 start -->
                <div id="copyright">
            <ul>
                <li>&copy;Powered By <a href="https://hexo.io/zh-cn/" style="border-bottom: none;">hexo</a></li>
                <li>Design: <a href="http://miccall.tech " style="border-bottom: none;">miccall</a></li>
            </ul>
            
            	<span id="busuanzi_container_site_pv">2018总访问量<span id="busuanzi_value_site_pv"></span>次</span>
			
        </div>
    </div>

</body>




 	
</html>
